# 테스트 코드

## 규약
1. 파일명이 `_test.go`로 끝나야함.
2. testing 패키지를 임포트해야함.
3. 테스트 코드는 `func TestXxxx(t *testing.T)` 형태여야함.

## 명령어
```sh
go test
go test -run <Test 명>
```

## stretchr/testify
- 테스트 코드 작성을 돕는 외부 패키지
- 테스트하고 테스트 실패를 알릴 수 있는 다양한 함수를 제공

### 유용한 함수들

- `Equal()` : expected와 actual 두 값을 비교하여 다를 경우 테스트를 실패, 메시지를 출력
- `Greater()` : e1이 e2보다 크지 않으면 테스트를 실패하고 메시지를 출력
- `Len()` : object의 항목 개수가 length가 아니면 테스트를 실패, 메시지를 출력
- `NotNilf()` : object가 nil이면 테스트를 실패하고 메시지를 출력
- `NotEqualf()` : expected와 actual이 같으면 테스트를 실패하고 메시지를 출력

### 그 외의 유용한 기능
- mock : 테스트용 목업을 만드는 데 유용, 모듈의 행동을 가장하는 mockup 객체를 제공합니다. 
    - 예를 들어 온라인 기능을 테스트할 때 하위 영역인 네트워크 영역까지 모두 테스트하기 힘들기 때문에, 네트워크 객체를 가장하는 목업 객체를 만들때 유용
- suite : 테스트 준비 작업이나 테스트 종료 후 뒤처리 작업을 쉽게 할 수 있도록 도와주는 패키지
    - 예를 들어 테스트에 특정 파일이 있어야 한다면 테스트 시작 전 임시 파일을 생성하고 테스트 종료 후 생성한 임시 파일을 삭제해 주는 작업을 만들때 유용

## TDD
- 필요성
    1. 과거에 비패 프로그램 규모가 커미
    2. 고가용성(high availability)에 대한 요구사항이 높아짐

### 종류
1. 블랙박스 테스트
- 제품 내부를 오픈하지 않은 상태에서 진행되는 테스트
- 사용자 입장에서 테스트한다고 해서 "사용성 테스트"라고 하기도 함
- 프로그램을 실행한 상태로 실행 동작을 검사하는 방식

2. 화이트 박스 테스트
- 프로그램 내부 코드를 직접 검증하는 방식
- Unit Test
- 프로그래머가 직접 테스트 코드를 작성해서 내부 테스트를 검사하는 방식
```
코드 작성 -> 테스트 -> 완성
        ^        | (버그 발견)
        ㄴ 코드수정 <
```

### 테스트 주도 개발
테스트 코드 작성 시기를 과감하게 코드 작성 이전으로 옮긴 방식
1. 제일 먼저 테스트 코드를 작성
2. 처음에는 당연히 실패함
2-1. 방금 작성한 테스트를 성공시키는 코드를 작성해서 테스트를 성공시킴. 그리고 개선 작업을 통해 코드 개선 (SOLID에 입각해 진행)
3. 새로운 테스트 코드 작성 및 반복
```
테스트 작성 -> 테스트 실패 -> 코드 작성 -> 완성
^                          |     ^
|                          |     |
ㄴ-------  개선 <-------  테스트성공  |
           ㄴ---------------------
```

## 벤치마크
- 코드 성능을 검사하는 벤치마크 기능제공
- testing 패키지에서 제공

### 규약
1. 파일명이 `_test.go`로 끝나야함
2. testing 패키지를 임포트
3. 벤치마크 코드는 `func BenchMarkXxxx(b *testing.B)` 형태